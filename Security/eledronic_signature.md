# 전자서명

## 전자서명의 형식
암호방식에 따라 크게 두가지로 구별된다.
1. 공개키 암호방식의 공개키 서명방식
2. 관용 암호방식의 중재서명방식

### 과정
1. 송신자는 서명 알고리즘을 통해 메시지에 서명을 한다.
2. 메시지와 서명은 수신자에게 전송된다.
3. 수신자는 메시지와 서명을 받고 이들에게 검증 알고리즘을 적용한다.
4. 만약 그 결과가 참이면 메시지는 올바른 것으로 받아들여지지만, 그렇지 않으면 그 문서는 거절된다.

#### 키의 필요성
전자서명에서 서명자는 자신의 개인키를 이용하여 문서에 서명을 하게 된다.
이때 서명 알고리즘을 사용한다.

검증하는 사람은 역으로 서명자의 공개키를 이용하여 문서를 검증한다.
이때 검증 알고리즘을 사용한다.

### 전자서명 서비스

#### 메시지 인증
안전한 전통적인 서명처럼 안전한 전자서명구조는 메시지 인증을 보장한다.
Bob는 받은 메시지가 Alice로부터 왔다는 것을 확신할 수 있게 된다.

#### 메시지 무결성
메시지 무결성은 전체 메시지에 서명을 할 경우에도 보장이 된다.
왜냐하면 메시지가 변경되면 서명도 같이 달라지기 때문이다.

#### 부인방지
만약 나중에 Alice가 그 메시지를 보낸 사실을 부인한다면
센터는 저장하고 있는 메시지를 제시할 수 있다.

만약 bob의 메시지가 센터가 보관하고 있는 메시지의 복사본과 같다면
Alice는 법정에서 패하게 될 것이다.

#### 기밀성
전자서명을 한다고 해서 기밀성이 보장되는 통신을 할 수는 없다.
만약 기밀성이 필요하다면 메시지와 서명에 비밀키를 이용하거나 공개키를 이용해서 암호화를 해야만 한다.

### 전자서명의 주요 기능
1. 위조 불가(Unforgeable):
    합법적인 서명자만이 전자서명을 생성할 수 있어야 한다.

2. 서명자 인증(User authentication):
    전자서명의 서명자를 누구든지 검증할 수 있어야 한다.

3. 부인방지(NOn-requdiation):
    서명자는 서명행위 이후에 서명한 사실을 부인할 수 없어야 한다.

4. 변경 불가(Unalterable):
    서명한 문서의 내용을 변경할 수 없어야 한다.

5. 재사용 불가(Not reusable): 
    전자문서의 서명을 다른 전자문서의 서명으로 사용할 수 없어야 한다.

## 전자서명 구조
### RSA 전자서명 구조(RSA digital signature scheme)
RSA 아이디어를 이용하면 메시지에 서명을 하고 검증을 할 수 있다.
이것을 RSA 전자서명 구조라고 한다.

RSA 암호 방식을 이용한 전자 서명의 안전도는 RSA 암호 방식의 안전도와 일치한다.

전자서명 구조에서는 개인키와 공개키의 역할이 바뀐다.
암호화의 경우에서처럼 수신자의 키를 사용하는 것이 아닌, 송신자의 개인키와 공개키를 사용한다.
(송신자의 개인키로 암호화를 진행하여, 누구나 열어 볼 수 있도록 하는 것이다)

### ElGamal 전자서명 구조
ElGamal 전자서명은 ElGamal 암호시스템과 동일한 키를 사용하지만 알고리즘은 다르다.
이는 이산대수 문제를 이용한 최초의 서명방식이기 때문이다.

암호화 연산과 전자서명 연산이 거의 동일한 RSA와 달리 ElGamal 전자서명은 암호화 스키마와 꽤 다르다.

이 알고리즘은 실제로 거의 사용되지않으며, 대신 DSA라 알려진 그 변형이 더욱 더 많이 사용된다.


### Schnorr 전자서명 구조
ElGamal 전자서명 구조의 문제인 이산대수 문제로부터 안전해지기 위해 만들어졌다.

해당 서명의 크기를 줄이기 위해서 Schnorr은 ElGamal에 기반을 두고 있지만 서명의 크기는 작은 새로운 구조를 제안하였따.

### 전자서명 표준(DSS, Digital Signature Standard)
전자서명 표준, 이하 `DSS`는 미국의 전자서명 표준으로 `ElGamal` 전자서명을 개량한 방식이다.
전자서명 표준은 `ElGamal` 전자서명 방식과 유사하지만 서명과 검증에 소요되는 계산량을 획기적으로 줄인 방식이다.

`DSS`는 이산대수 문제를 기반으로 하며, 오직 전자서명 기능만을 제공하도록 설계된 알고리즘을 사용한다.

`RSA`와 달리, 이것은 암호화나 키 교환에 사용되지 않지만 공개키 기술이다.

DSA(Digital Signature Standard)는 전자서명에 대한 미 연방 표준 `DSS`이고 `NIST`가 제안하였다.
`ElGamal` 서명 스키마보다 서명 길이가 320비트로 짧고, ElGamal에 대한 공격 중 일부가 적용되지 않는다는 것이다.
|알고리즘|암호/복호|전자서명|키 교환|
|:-:|:-:|:-:|:-:|
|RSA|Yes|Yes|Yes|
|Diffie-Hellman|No|No|Yes|
|DSS|No|Yes|No|
|타원 곡선|Yes|Yes|Yes|
> 공개키 암호시스템의 응용
  
### 타원곡선 전자서명 구조
타원곡선 전자서명 구조(ellptic curve digital scheme)는 타원곡선에 기반을 둔 **DSA**이다.
그렇기에 이 구조는 **ECDSA**라고 부른다.

ECC는 보다 짧은 비트 길이로 인해 짧은 처리 시간에 짧은 서명 생성이 가능하다.
이런 이유로 1998년 **ANSI**(American National standards Institue)가 **ECDSA**를 미국에서 표준화하였다.

## 전자서명 방식

### 메시지 복원형 전자서명
1. 서명자가 자신의 개인키를 이용하여 메시지를 암호화하여 전송하면
2. 검증자가 서명자의 공개키를 이용하여 서명된 암호문을 복호화한다.
3. 그 결과가 일정한 규칙을 만족하는 의미 있는 메시지가 되는지 확인함으로써 서명을 검증한다.
- 장점
    기존의 공개키 암호 방식을 이용하므로 별도의 전자서명 프로토콜이 필요하지 않는다는 장점이 있다.
- 단점
    그러나 메시지를 일정한 블럭으로 나누어 그 각각의 블럭에 서명을 해야 하므로 많은 시간이 소요되어 실제로는 사용되지 않는다.

![메시지 복원형 전자서명](image/전자서명1.png)
> 앨리스는 미리 공개키와 개인키의 키쌍을 만들어둔다, 또한 밥이 서명을 검증하기 위해 앨리스의 공개키를 입수해야한다.

### 부가형 전자서명
임의의 길이로 주어진 메시지를 해시 알고리즘을 이용해 일정한 길이로 압축하고, 해시한 결과에 서명자의 개인키를 이용하여 전자서명한 후 메시지에 덧붙여 전송한다.

전자서명의 검증은 수신된 메시지를 해시한 결과와 공개키를 이용하여 전자서명을 복호화한 값과 비교함으로써 이루어진다.

부가형 전자서명은 메시지 이외에 전자서명을 따로 전송해야 하므로 전송량이 약간 늘어나는 반면, 메시지가 아무리 길어도 한 번의 서명생성 과정만이 필요하므로 효율적이다.
그러기에 많이 사용되는 편이다.

![부가형 전자서명](image/전자서명2.png)
1. 메시지 전체를 암호화하는 대신에 일방향 해시함수를 사용해서 메시지의 해시값을 구하고, 그 해시값을 암호화(해시값에 서명)하도록 한다.
2. 메시지가 아무리 길어도 해시값을 짧기에 암호화가 수월해진다.

## 특수 전자서명
공개키 방식을 이용한 전자 서명은 검증키를 공개하고 있어 누구나 서명의 진위를 검증할 수 있으나
전자 서명을 제한적으로 사용하려고 하는 경우 제한하기가 곤란하다.
이는 개인의 이익 침해나 사생활 노출로 이어질 수 있다.

따라서 서명자의 동의가 있어야 검증이 가능하거나 서명문의 내용을 알지 못하게 하고 서명해야 하는 경우 등 다양한 형태에 맞는 전자서명이 필요하다.

### 부인방지 전자서명
일반적인 전자 서명 방식의 서명 검증은 검증자가 임의로 할 수 있으며, 누구든지 검증이 가능한
**자체 인증 기능 특성**을 가지고 있다.
그러나 `D.Chaum`이 제안한 부인 방지 서명(undeniable signature)은 자체 인증 방식을 배제시켜 서명을 검증할 때 반드시 서명자의 도움이 있어야 검증이 가능한 전자 서명 방식이다.

### 의뢰 부인방지 서명
부인 방지 서명 방식은 자신의 서명문을 부인하지 못하게 하는 부인과정 때문에 일종의 **거짓말 탐지기 기능**을 제공해준다.

위의 기능은 결국 검증을 원하는 검증자가 부인 과정을 수행할 수 있다는 데서 기인된다.

따라서 부인 방지 서명의 **거짓말 탐지 기능** 문제를 해결하기 위해서는
임의의 검증자가 부인 과정을 수행하지 못하고 특정한 자, 즉 일종의 해결자 또는 재판관만이 부인 과정을 수행할 수 있어야 한다.

